<!DOCTYPE html>
<html>
<head><title>Buyer Register</title></head>
<body style="font-family:Arial,sans-serif;background:#f5f5f5;margin:0;padding:0;">
 
 

 <!DOCTYPE html>
<html>
<head><title>Buyer Register</title></head>
<body style="font-family:Arial,sans-serif;background:#f5f5f5;margin:0;padding:0;">

  <div id="navbar-container"></div>

  <form id="registerForm" onsubmit="submitForm(event)" style="width:90%;max-width:300px;margin:190px auto 50px;background:#fff;padding:25px 20px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.1);">
    <h2 style="text-align:center;margin-bottom:20px;">Buyer Registration</h2>

    <label style="display:block;margin-bottom:5px;font-weight:bold;">Name *</label>
    <input type="text" id="name" style="width:90%;padding:10px;margin-bottom:15px;border:1px solid #ccc;border-radius:5px;" placeholder="Full Name" required>

    <label style="display:block;margin-bottom:5px;font-weight:bold;">Email *</label>
    <input type="email" id="email" style="width:90%;padding:10px;margin-bottom:15px;border:1px solid #ccc;border-radius:5px;" placeholder="your@email.com" required>

    <label style="display:block;margin-bottom:5px;font-weight:bold;">Phone Number *</label>
    <input type="tel" id="phone" style="width:90%;padding:10px;margin-bottom:15px;border:1px solid #ccc;border-radius:5px;" placeholder="10-digit number" required>

    <label style="display:block;margin-bottom:5px;font-weight:bold;">Address *</label>
    <input type="text" id="address" style="width:90%;padding:10px;margin-bottom:15px;border:1px solid #ccc;border-radius:5px;" placeholder="Your address" required>

    <label style="display:block;margin-bottom:5px;font-weight:bold;">Password *</label>
    <input type="password" id="password" style="width:90%;padding:10px;margin-bottom:20px;border:1px solid #ccc;border-radius:5px;" placeholder="Min 6 characters" required>

    <div style="text-align:center;">
      <button type="submit" style="width:50%;padding:12px;background:#28a745;color:#fff;border:none;border-radius:5px;font-size:16px;cursor:pointer;font-weight:bold;">Register</button>
    </div>

    <p style="margin-top:15px;text-align:center;font-size:14px;">Already have an account?
      <a href="login.html" style="color:#007BFF;text-decoration:none;font-weight:bold;">Login</a>
    </p>

    <p id="message" style="margin-top:15px;padding:10px;border-radius:5px;text-align:center;font-size:14px;display:none;font-weight:bold;"></p>
  </form>

  <script>
    function submitForm(event) {
      event.preventDefault();
      
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const address = document.getElementById('address').value.trim();
      const password = document.getElementById('password').value;
      const messageEl = document.getElementById('message');

      // Validation
      if (!name || !email || !phone || !address || !password) {
        messageEl.style.color = 'red';
        messageEl.innerText = '‚ùå Please fill in all required fields.';
        messageEl.style.display = 'block';
        return;
      }

      const phoneRegex = /^[6-9]\d{9}$/;
      if (!phoneRegex.test(phone)) {
        messageEl.style.color = 'red';
        messageEl.innerText = '‚ùå Please enter a valid 10-digit mobile number starting with 6-9.';
        messageEl.style.display = 'block';
        return;
      }

      if (password.length < 6) {
        messageEl.style.color = 'red';
        messageEl.innerText = '‚ùå Password must be at least 6 characters long.';
        messageEl.style.display = 'block';
        return;
      }

      messageEl.style.color = '#007BFF';
      messageEl.innerText = '‚è≥ Processing registration...';
      messageEl.style.display = 'block';

      console.log('üìù Sending buyer registration data:', { name, email, phone, address });

      fetch('http://localhost:5000/api/buyer-profile', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, email, phone, address, password })
      })
      .then(response => {
        console.log('üì° Response status:', response.status);
        return response.json().then(data => ({ status: response.status, data }));
      })
      .then(({ status, data }) => {
        console.log('üì® Response data:', data);
        
        if (status === 200) {
          messageEl.style.color = 'green';
          messageEl.innerText = '‚úÖ ' + (data.message || 'Registration successful! Redirecting to login...');
          messageEl.style.display = 'block';
          document.getElementById('registerForm').reset();
          setTimeout(() => {
            window.location.href = 'login.html';
          }, 2000);
        } else {
          messageEl.style.color = 'red';
          messageEl.innerText = '‚ùå ' + (data.error || data.message || 'Registration failed. Please try again.');
          messageEl.style.display = 'block';
        }
      })
      .catch(error => {
        console.error('‚ùå Error:', error);
        messageEl.style.color = 'red';
        messageEl.innerText = '‚ùå Error: Unable to reach server. Make sure it is running on port 5000.';
        messageEl.style.display = 'block';
      });
    }
  </script>
  
  <div id="footer-placeholder"></div>

<script>
fetch('footer.html')
  .then(response => response.text())
  .then(data => {
    document.getElementById('footer-placeholder').innerHTML = data;
  })
  .catch(error => console.error('Footer load error:', error));
</script>


    <script>
  // Load shared navbar (injects navbar.html body and executes its scripts)
  async function includeNavbar() {
    try {
      const res = await fetch('navbar.html');
      const text = await res.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(text, 'text/html');
      document.getElementById('navbar-container').innerHTML = doc.body.innerHTML;

      // Execute scripts from navbar.html and wait for external scripts to load
      const __createdScriptPromises = [];
      doc.querySelectorAll('script').forEach(s => {
        const newScript = document.createElement('script');
        if (s.src) {
          newScript.src = s.src;
          newScript.async = false;
          __createdScriptPromises.push(new Promise(resolve => {
            newScript.addEventListener('load', resolve);
            newScript.addEventListener('error', resolve);
            setTimeout(resolve, 2000);
          }));
        } else {
          newScript.textContent = s.textContent;
        }
        document.body.appendChild(newScript);
      });
      Promise.all(__createdScriptPromises).finally(() => {});

      // Ensure navbar init functions run after dynamic injection (wait for external scripts to load)
      const __navbarScriptPromises = [];
      doc.querySelectorAll('script').forEach((s, i) => {
        const existing = document.querySelectorAll('script')[document.querySelectorAll('script').length - 1 - i];
        if (existing && existing.src) {
          __navbarScriptPromises.push(new Promise(resolve => {
            existing.addEventListener('load', resolve);
            existing.addEventListener('error', resolve);
            // also resolve after 2s as a safety
            setTimeout(resolve, 2000);
          }));
        }
      });
      Promise.all(__navbarScriptPromises).finally(() => {
        if (typeof checkScreenSize === 'function') checkScreenSize();
        if (typeof addDesktopHoverEffects === 'function') addDesktopHoverEffects();
        if (typeof updateUserUI === 'function') updateUserUI();
        if (typeof updateCartBadge === 'function') updateCartBadge();
        if (typeof setActiveNavLink === 'function') setActiveNavLink();
      });
    } catch (e) {
      console.error('Failed to load navbar:', e);
    }
  }
  includeNavbar();
</script>

</body>
</html>

